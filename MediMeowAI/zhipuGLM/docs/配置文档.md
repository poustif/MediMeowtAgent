# 项目环境配置与部署文档

## 1. 虚拟环境创建与激活

为确保项目依赖的隔离性与稳定性，建议在项目根目录下创建独立的 Python 虚拟环境。

**前置要求**：请确保系统中已安装 Python 3.12 版本。

首先打开终端（Terminal），执行以下命令检查 Python 版本：

```powershell
python --version
```

确认版本无误后，创建名为 `.venv` 的虚拟环境：

```powershell
python -m venv .venv
```

接着激活虚拟环境（以下命令适用于 Windows PowerShell）：

```powershell
.\.venv\Scripts\Activate.ps1
```

*注：激活成功后，终端命令行前缀会出现 `(.venv)` 标识。*

## 2. 依赖安装与镜像源配置

为了提高依赖包的下载速度并确保稳定性，建议配置清华大学开源软件镜像站（Tsinghua Open Source Mirror）。

**配置 pip 镜像源并更新 pip：**

```powershell
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple
python -m pip install --upgrade pip
```

**安装项目依赖：**
执行以下命令安装 `langchain` 生态及相关组件：

```powershell
pip install langchain langchain-community langchain-chroma langchain-openai sentence-transformers requests
```

请耐心等待所有依赖包安装完成。

## 3. API 密钥配置 (Configuration)

本项目依赖智谱 AI (ZhipuAI) 的模型服务。

1. **获取**获取密钥**：访问 [智谱 AI 开放平台](https://bigmodel.cn/login?redirect=%2Fusercenter%2Fproj-mgmt%2Fapikeys) 并注册/登录，创建一个新的 API Key。
2. **修改配置文件**：打开项目目录下的 `config/config.py` 文件，定位到 API 配置部分。
3. **填入密钥**：将获取到的 API Key 替换掉 \`os.environ`os.environ["GLM_API_KEY"]` 中的空字符串。

*修改前：*

```python
os.environ["GLM_API_KEY"] = ""
```

*修改后（示例）：*

```python
# ==========================
# API 配置
# =========================================================

# 请将 "your_api_key_here" 替换为您实际申请到的 key，保留引号
os.environ["GLM_API_KEY"] = "1234567890abcdef.12345678" 
GLM_API_BASE = "https://open.bigmodel.cn/api/paas/v4/"
```

## 4. 测试数据准备

为了测试图像识别功能，请准备测试样本：

1.  在项目根目录下创建一个名为 `pic` 的文件夹。
2.  准备一张清晰的舌苔图片（可通过网络检索获取），将其重命名为 `tongue_sample.png`。
3.  将该图片存入 `pic` 文件夹中。

## 5. 配置 Hugging Face 中文镜像（临时环境变量）

由于网络环境原因，直接连接 Hugging Face Hub 下载词嵌入模型（Embedding Models）可能会失败。建议在当前终端会话中设置临时环境变量以使用国内镜像。

在终端输入以下命令（Windows PowerShell）：

```powershell
$env:HF_ENDPOINT = "https://hf-mirror.com"
```

*注：此命令仅在当前终端窗口有效，关闭后失效。*

## 6. 启动项目

### 主程序运行

确保以上步骤均已完成后，运行主程序：

```powershell
python main.py
```

**注意事项**：

* 首次运行时，系统会自动从 Hugging Face 拉取词嵌入模型（Embedding Model）并在本地建立索引。根据网络状况，这可能需要几分钟时间，请耐心等待。

### 服务模块测试 (Beta)

若需对服务接口进行独立测试，可运行 `service.py`。

```powershell
python service.py
```

*注：该模块主要用于开发调试，可能包含未修复*注：该模块主要用于开发调试，可能包含未修复的逻辑或不稳定性，仅供测试使用
